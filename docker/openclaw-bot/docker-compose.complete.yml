# OpenClaw Debate Bot - Complete All-in-One Setup
#
# This runs everything needed for an AI-powered debate bot:
# - OpenClaw gateway (connects to Claude/GPT)
# - Bridge bot (exposes debate endpoint)
#
# Usage:
#   # With Anthropic Claude:
#   ANTHROPIC_API_KEY=sk-ant-xxx docker compose -f docker-compose.complete.yml up
#
#   # With OpenAI GPT:
#   OPENAI_API_KEY=sk-xxx docker compose -f docker-compose.complete.yml up
#
# The bot will be available at http://localhost:4200/debate

services:
  openclaw-debate-bot:
    build:
      context: ../..
      dockerfile: docker/openclaw-bot/Dockerfile.complete
    ports:
      - "4200:4200"    # Debate endpoint
      - "18789:18789"  # OpenClaw gateway (optional, for debugging)
    environment:
      # AI Provider API Key (set one of these)
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      # Optional: Custom webhook token
      - OPENCLAW_TOKEN=${OPENCLAW_TOKEN:-}
      # Bot configuration
      - PORT=4200
      - OPENCLAW_URL=http://localhost:18789
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:4200/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    restart: unless-stopped
