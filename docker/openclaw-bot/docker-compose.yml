# OpenClaw Bridge Bot - Docker Compose
#
# This runs the bridge bot that connects to your local OpenClaw gateway.
# You must run OpenClaw separately on your host machine.
#
# Setup:
#   1. Install OpenClaw: npm install -g openclaw@latest
#   2. Configure: openclaw onboard --install-daemon
#   3. Start gateway: openclaw gateway --port 18789
#   4. Run this: docker compose up
#
# The bot will be available at http://localhost:4200/debate

services:
  openclaw-bot:
    build:
      context: ../..
      dockerfile: docker/openclaw-bot/Dockerfile
    ports:
      - "4200:4200"
    environment:
      # Point to OpenClaw running on host machine
      - OPENCLAW_URL=http://host.docker.internal:18789
      # Optional: webhook token (must match your OpenClaw config)
      - OPENCLAW_TOKEN=${OPENCLAW_TOKEN:-}
      - PORT=4200
    extra_hosts:
      - "host.docker.internal:host-gateway"
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:4200/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
